import{a as N}from"./assets/vendor-CJ4cOYKs.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();N.create({baseURL:"https://furniture-store.b.goit.study/api",timeout:5e3});const c=document.querySelector("[data-order-modal]"),m=c.querySelector(".order-form");c.querySelector("[data-order-close]");let k=null,q=null;function H(e="",t=""){k=e,q=t,c.classList.remove("is-hidden"),document.body.style.overflow="hidden"}function L(e=!1){c.classList.add("is-hidden"),document.body.style.overflow="auto",e&&m.reset()}c.addEventListener("click",e=>{(e.target===c||e.target.closest("[data-order-close]"))&&L()});window.addEventListener("keydown",e=>{e.key==="Escape"&&!c.classList.contains("is-hidden")&&L()});const l=m.elements.phone,g=m.elements.name;let v=C(l),M=C(g);function C(e){let t=e.nextElementSibling;return(!t||!t.classList.contains("error-message"))&&(t=document.createElement("span"),t.classList.add("error-message"),e.insertAdjacentElement("afterend",t)),t}function x(e){let t=e.replace(/\D/g,"");return t.startsWith("0")&&(t=t.slice(1)),t.startsWith("38")||(t="38"+t),t.length>2?"+"+t.slice(0,2)+" "+t.slice(2,5)+" "+t.slice(5,8)+" "+t.slice(8,12):"+"+t}function F(){l.value=x(l.value);const e=l.value.replace(/\D/g,"");return e.length===12&&e.startsWith("38")?(l.classList.remove("error"),v.textContent="",!0):(l.classList.add("error"),v.textContent="Невірний номер телефону",!1)}function A(){return g.value.trim().length>=2?(g.classList.remove("error"),M.textContent="",!0):(g.classList.add("error"),M.textContent="Введіть ім’я (мінімум 2 символи)",!1)}l.addEventListener("input",()=>{l.value=x(l.value),l.classList.remove("error"),v.textContent=""});m.addEventListener("submit",async e=>{if(e.preventDefault(),!(A()&F()))return;const s=new FormData(m),n={name:s.get("name").trim(),phone:s.get("phone").trim(),comment:s.get("comment")?.trim(),furnitureId:k,marker:q};try{const r=await fetch("/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const o=await r.json();throw new Error(o.message||"Помилка сервера")}iziToast.success({title:"Успіх",message:"Заявка відправлена!"}),L(!0)}catch(r){iziToast.error({title:"Помилка",message:r.message})}});const a=document.querySelector("[data-modal]");let O=null,T=null;function D(e){document.body.style.overflow="hidden",a.classList.remove("is-hidden"),O=e._id||e.id||"",T=e.marker||"",a.querySelector(".modal-title").textContent=e.name,a.querySelector(".modal-category").textContent=e.category.name,a.querySelector(".modal-price").textContent=`${e.price} грн`,a.querySelector(".modal-description").textContent=e.description,a.querySelector(".modal-sizes").textContent=`Розміри: ${e.sizes}`,z(e.images),B(e.rate),W(e.color||[])}function z(e){const t=a.querySelector(".modal-gallery");if(!e||e.length===0){t.innerHTML="<p>Немає зображень</p>";return}const s=`<div class="main-image"><img src="${e[0]}" alt="Основне фото" /></div>`,n=e.slice(1).map((r,o)=>`<div class="thumb"><img src="${r}" alt="Фото ${o+2}" /></div>`).join("");t.innerHTML=s+`<div class="thumbs-row">${n}</div>`}function B(e){const t=a.querySelector(".modal-rate"),s=Math.floor(e),n=e%1>=.5,r=5-s-(n?1:0);let o="";o+='<svg class="modal-star">'.repeat(s).replace(/>/g,'><use href="./img/sprite.svg#icon-star"></use></svg>'),n&&(o+='<svg class="modal-star"><use href="./img/sprite.svg#icon-star-half"></use></svg>'),o+='<svg class="modal-star">'.repeat(r).replace(/>/g,'><use href="./img/sprite.svg#icon-star-empty"></use></svg>'),t.innerHTML=o}function W(e){const t=a.querySelector(".modal-colors"),s='<p class="color-label-title">Колір</p>',n=e.map((r,o)=>`
      <label class="color-label">
        <input type="radio" name="color" value="${r}" ${o===0?"checked":""}/>
        <span class="color-dot" style="background-color:${r}"></span>
      </label>`).join("");t.innerHTML=s+`<div class="color-label-group">${n}</div>`}a.addEventListener("click",e=>{(e.target.closest("[data-close]")||e.target===a)&&S()});window.addEventListener("keydown",e=>{e.key==="Escape"&&S()});const V=a.querySelector("[data-order]");V?.addEventListener("click",()=>{S(),H(O,T)});function S(){a.classList.add("is-hidden"),document.body.style.overflow="auto"}const P=document.querySelectorAll(".card"),$=document.querySelector(".price-list"),b=document.getElementById("load-more-btn");let d="all",f=1;const h=8;let u=[],y=null;const p=Array.from(P).find(e=>e.dataset.category==="all");p&&(p.classList.add("selected"),y=p,d=p.dataset.category);P.forEach(e=>{e.addEventListener("click",t=>{const s=t.target.closest(".card");s&&(y&&y.classList.remove("selected"),s.classList.add("selected"),y=s,d=s.dataset.category,console.log("Клік по категорії:",d),f=1,u=[],E(d,f,h).then(n=>{$.innerHTML="",w(n),b.style.display=n.length<h?"none":"block"}))})});function E(e,t=1,s=8){let n=`https://furniture-store.b.goit.study/api/furnitures?page=${t}&limit=${s}`;return e&&e!=="all"&&(n+=`&category=${e}`),fetch(n).then(r=>{if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);return r.json()}).then(r=>r.furnitures).catch(r=>(console.error("Помилка при завантаженні меблів за категорією:",r),[]))}function w(e){u=u.concat(e);const t=e.map((s,n)=>{const o=`
        <div class="color-label-group">
          ${(s.colors||["#c7c3bb","#c7aa80","#201a19"]).map((i,j)=>`
                <label class="color-label">
                  <input type="radio" name="color-${n}" value="${i}" ${j===0?"checked":""} />
                  <span class="color-dot" style="background-color:${i}"></span>
                </label>
              `).join("")}
        </div>
      `;return`
        <div class="price" data-index="${u.length-e.length+n}">
          <img class="price-image" src="${s.images[0]}" alt="${s.name}" />
          <h2 class="price-title">${s.name}</h2>
          ${o}
          <p class="price-price">${s.price} грн</p>
          <button class="my-button">Детальніше</button>
        </div>
      `}).join("");$.insertAdjacentHTML("beforeend",t)}b.addEventListener("click",()=>{f+=1,E(d,f,h).then(e=>{e.length===0&&(b.style.display="none"),w(e)})});$.addEventListener("click",e=>{const t=e.target.closest(".my-button");if(!t)return;const s=t.closest(".price"),n=Number(s.dataset.index);if(!isNaN(n)){const r=u[n];r&&D(r)}});E(d,f,h).then(w);document.querySelectorAll(".accordion").forEach(e=>{e.addEventListener("show.bs.collapse",t=>{t.target.closest(".accordion-item").classList.add("active")}),e.addEventListener("hide.bs.collapse",t=>{t.target.closest(".accordion-item").classList.remove("active")})});
//# sourceMappingURL=index.js.map
