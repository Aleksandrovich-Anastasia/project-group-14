import{a as I,R as W,S as Z,N as G,P as J}from"./assets/vendor-CvoFX1z6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();const K=I.create({baseURL:"https://furniture-store.b.goit.study/api",timeout:5e3}),k=document.querySelector("[data-menu-open]"),S=document.querySelector("[data-menu-close]"),p=document.querySelector(".menu-header"),H=document.body;k.addEventListener("click",()=>{p.classList.add("is-open"),H.classList.add("no-scroll"),k.style.display="none",S.style.display="block"});function b(){p.classList.remove("is-open"),H.classList.remove("no-scroll"),S.style.display="none",k.style.display="block"}S.addEventListener("click",b);document.addEventListener("keydown",e=>{e.key==="Escape"&&p.classList.contains("is-open")&&b()});document.addEventListener("click",e=>{p.classList.contains("is-open")&&!e.target.closest(".menu-header")&&!e.target.closest("[data-menu-open]")&&b()});p.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{const r=document.querySelector(e.getAttribute("href"));r&&r.scrollIntoView({behavior:"smooth"}),b()})});const i=document.querySelector("[data-order-modal]"),m=i.querySelector(".order-form");i.querySelector("[data-order-close]");let N=null,j=null;function U(e="",t=""){N=e,j=t,i.classList.remove("is-hidden"),document.body.style.overflow="hidden"}function x(e=!1){i.classList.add("is-hidden"),document.body.style.overflow="auto",e&&m.reset()}i.addEventListener("click",e=>{(e.target===i||e.target.closest("[data-order-close]"))&&x()});window.addEventListener("keydown",e=>{e.key==="Escape"&&!i.classList.contains("is-hidden")&&x()});const c=m.elements.phone,v=m.elements.name;let C=F(c),B=F(v);function F(e){let t=e.nextElementSibling;return(!t||!t.classList.contains("error-message"))&&(t=document.createElement("span"),t.classList.add("error-message"),e.insertAdjacentElement("afterend",t)),t}function V(e){let t=e.replace(/\D/g,"");return t.startsWith("0")&&(t=t.slice(1)),t.startsWith("38")||(t="38"+t),t.length>2?"+"+t.slice(0,2)+" "+t.slice(2,5)+" "+t.slice(5,8)+" "+t.slice(8,12):"+"+t}function _(){c.value=V(c.value);const e=c.value.replace(/\D/g,"");return e.length===12&&e.startsWith("38")?(c.classList.remove("error"),C.textContent="",!0):(c.classList.add("error"),C.textContent="Невірний номер телефону",!1)}function Q(){return v.value.trim().length>=2?(v.classList.remove("error"),B.textContent="",!0):(v.classList.add("error"),B.textContent="Введіть ім’я (мінімум 2 символи)",!1)}c.addEventListener("input",()=>{c.value=V(c.value),c.classList.remove("error"),C.textContent=""});m.addEventListener("submit",async e=>{if(e.preventDefault(),!(Q()&_()))return;const r=new FormData(m),n={name:r.get("name").trim(),phone:r.get("phone").trim(),comment:r.get("comment")?.trim(),furnitureId:N,marker:j};try{const s=await fetch("/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok){const o=await s.json();throw new Error(o.message||"Помилка сервера")}iziToast.success({title:"Успіх",message:"Заявка відправлена!"}),x(!0)}catch(s){iziToast.error({title:"Помилка",message:s.message})}});const a=document.querySelector("[data-modal]");let D=null,z=null;function X(e){document.body.style.overflow="hidden",a.classList.remove("is-hidden"),D=e._id||e.id||"",z=e.marker||"",a.querySelector(".modal-title").textContent=e.name,a.querySelector(".modal-category").textContent=e.category.name,a.querySelector(".modal-price").textContent=`${e.price} грн`,a.querySelector(".modal-description").textContent=e.description,a.querySelector(".modal-sizes").textContent=`Розміри: ${e.sizes}`,Y(e.images),ee(e.rate),te(e.color||[])}function Y(e){const t=a.querySelector(".modal-gallery");if(!e||e.length===0){t.innerHTML="<p>Немає зображень</p>";return}const r=`<div class="main-image"><img src="${e[0]}" alt="Основне фото" /></div>`,n=e.slice(1).map((s,o)=>`<div class="thumb"><img src="${s}" alt="Фото ${o+2}" /></div>`).join("");t.innerHTML=r+`<div class="thumbs-row">${n}</div>`}function ee(e){const t=a.querySelector(".modal-rate"),r=Math.floor(e),n=e%1>=.5,s=5-r-(n?1:0);let o="";o+='<svg class="modal-star">'.repeat(r).replace(/>/g,'><use href="./img/sprite.svg#icon-star"></use></svg>'),n&&(o+='<svg class="modal-star"><use href="./img/sprite.svg#icon-star-half"></use></svg>'),o+='<svg class="modal-star">'.repeat(s).replace(/>/g,'><use href="./img/sprite.svg#icon-star-empty"></use></svg>'),t.innerHTML=o}function te(e){const t=a.querySelector(".modal-colors"),r='<p class="color-label-title">Колір</p>',n=e.map((s,o)=>`
      <label class="color-label">
        <input type="radio" name="color" value="${s}" ${o===0?"checked":""}/>
        <span class="color-dot" style="background-color:${s}"></span>
      </label>`).join("");t.innerHTML=r+`<div class="color-label-group">${n}</div>`}a.addEventListener("click",e=>{(e.target.closest("[data-close]")||e.target===a)&&M()});window.addEventListener("keydown",e=>{e.key==="Escape"&&M()});const se=a.querySelector("[data-order]");se?.addEventListener("click",()=>{M(),U(D,z)});function M(){a.classList.add("is-hidden"),document.body.style.overflow="auto"}const R=document.querySelectorAll(".card[data-category-id]"),$=document.querySelector(".price-list"),E=document.getElementById("load-more-btn"),g=document.createElement("div");g.classList.add("loader");g.innerHTML='<div class="spinner"></div>';document.body.appendChild(g);function q(){g.style.display="flex"}function A(){g.style.display="none"}let d="all",f=1;const L=8;let u=[],h=null;const y=Array.from(R).find(e=>e.dataset.categoryId==="all");y&&(y.classList.add("selected"),h=y,d=y.dataset.categoryId);R.forEach(e=>{e.addEventListener("click",t=>{const r=t.target.closest(".card");r&&(h&&h.classList.remove("selected"),r.classList.add("selected"),h=r,d=r.dataset.categoryId,console.log("Клик по категории:",d),f=1,u=[],q(),O(d,f,L).then(n=>{$.innerHTML="",P(n),E.style.display=n.length<L?"none":"block",A()}))})});function O(e,t=1,r=8){let n=`https://furniture-store.b.goit.study/api/furnitures?page=${t}&limit=${r}`;return e&&e!=="all"&&(n+=`&category=${e}`),fetch(n).then(s=>{if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);return s.json()}).then(s=>s.furnitures).catch(s=>(console.error("Ошибка при загрузке мебели:",s),[]))}function P(e){u=u.concat(e);const t=e.map((r,n)=>{const o=`
        <div class="color-label-group">
          ${(r.color||["#C7C3BB","#C7AA80","#201A19"]).map((l,w)=>`
                <label class="color-label">
                  <input type="radio" name="color-${n}" value="${l}" ${w===0?"checked":""} />
                  <span class="color-dot" style="background-color:${l}"></span>
                </label>
              `).join("")}
        </div>
      `;return`
        <div class="price" data-index="${u.length-e.length+n}">
          <img class="price-image" src="${r.images[0]}" alt="${r.name}" />
          <h2 class="price-title">${r.name}</h2>
          ${o}
          <p class="price-price">${r.price} грн</p>
          <button class="my-button">Детальніше</button>
        </div>
      `}).join("");$.insertAdjacentHTML("beforeend",t)}E.addEventListener("click",()=>{f+=1,q(),O(d,f,L).then(e=>{e.length===0&&(E.style.display="none"),P(e),A()})});$.addEventListener("click",e=>{const t=e.target.closest(".my-button");if(!t)return;const r=t.closest(".price"),n=Number(r.dataset.index);if(!isNaN(n)){const s=u[n];s&&X(s)}});q();O(d,f,L).then(e=>{P(e),A()});document.querySelectorAll(".accordion").forEach(e=>{e.addEventListener("show.bs.collapse",t=>{t.target.closest(".accordion-item").classList.add("active")}),e.addEventListener("hide.bs.collapse",t=>{t.target.closest(".accordion-item").classList.remove("active")})});const re="data:image/svg+xml,%3csvg%20width='21'%20height='21'%20viewBox='0%200%2021%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.5709%201.19133C9.91464%200.326847%2011.0854%200.326848%2011.4291%201.19133L13.4579%206.29368C13.6029%206.65813%2013.9306%206.90714%2014.3067%206.93868L19.5727%207.38029C20.4649%207.45511%2020.8267%208.61981%2020.1469%209.22891L16.1348%2012.8239C15.8483%2013.0807%2015.723%2013.4837%2015.8106%2013.8675L17.0364%2019.2428C17.244%2020.1535%2016.2969%2020.8734%2015.533%2020.3854L11.0246%2017.5048C10.7025%2017.2991%2010.2975%2017.2991%209.9755%2017.5048L5.467%2020.3854C4.70312%2020.8734%203.75596%2020.1535%203.96364%2019.2428L5.18943%2013.8675C5.27699%2013.4837%205.15183%2013.0807%204.86527%2012.8239L0.853063%209.22891C0.173281%208.61981%200.535068%207.45511%201.42729%207.38029L6.69337%206.93868C7.06952%206.90714%207.39717%206.65813%207.54208%206.29368L9.5709%201.19133Z'%20fill='%23080C09'%20/%3e%3c/svg%3e",oe="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12%20.587l3.668%207.431%208.209%201.192-5.938%205.787%201.403%208.175L12%2018.896l-7.342%203.877%201.403-8.175L.123%209.21l8.209-1.192L12%20.587z'%20fill='%23E0E0E0'/%3e%3c/svg%3e",ne="data:image/svg+xml,%3csvg%20width='21'%20height='21'%20viewBox='0%200%2021%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20.393%207.9851L20.4727%208.24826C20.5383%208.44688%2020.4831%208.66762%2020.3331%208.80615L15.4865%2013.1745L16.9225%2019.7218C16.9711%2019.9311%2016.8965%2020.1508%2016.733%2020.2797L16.5136%2020.4376C16.4284%2020.5081%2016.3227%2020.5453%2016.2145%2020.5429C16.1231%2020.5449%2016.0332%2020.5193%2015.9552%2020.4692L10.5002%2016.964L5.07514%2020.4692C4.99714%2020.5193%204.90717%2020.5449%204.81585%2020.5429C4.7076%2020.5453%204.60189%2020.5081%204.51668%2020.4376L4.26736%2020.2797C4.10386%2020.1508%204.02926%2019.9311%204.07788%2019.7218L5.51393%2013.1745L0.677238%208.81667C0.519508%208.67897%200.459802%208.4521%200.52765%208.24826L0.637348%207.9851C0.695676%207.77713%200.871037%207.6299%201.07614%207.61669L7.44861%207.07985L9.89188%200.879924C9.97017%200.674026%2010.1604%200.540173%2010.3706%200.543086H10.6298C10.8381%200.538421%2011.0263%200.673661%2011.0985%200.879924L13.5817%207.07985L19.9542%207.61669C20.1593%207.6299%2020.3346%207.77713%2020.393%207.9851ZM14.6089%2017.4482L13.492%2012.5219L17.1519%209.22719L12.3551%208.8272L10.5002%204.13252V14.8061L14.6089%2017.4482Z'%20fill='%23080C09'%20/%3e%3c/svg%3e";function ae(e){return e>=3.3&&e<=3.7?3.5:e>=3.8&&e<=4.2?4:Math.round(e*2)/2}async function ce(){const e=document.querySelector(".feedback-list");if(e)try{const{data:t}=await K.get("/feedbacks",{params:{limit:10,page:1}}),n=(Array.isArray(t.feedbacks)?t.feedbacks.slice(0,10):[]).map(s=>{const o=ae(s.rate??0),l=s.descr||"",w=s.name||"Анонім";return`
          <li class="feedback-item swiper-slide">
            <div class="feedback-rating" data-score="${o}"></div>
            <p class="feedback-text text">${l}</p>
            <p class="feedback-user">${w}</p>         
          </li>
        `}).join("");e.innerHTML=n,e.querySelectorAll(".feedback-rating").forEach(s=>{const o=parseFloat(s.dataset.score);new W(s,{readOnly:!0,score:o,starOn:re,starOff:oe,starHalf:ne,half:!0}).init()}),new Z(".feedback-swiper",{modules:[G,J],navigation:{nextEl:".feedback-next",prevEl:".feedback-prev"},pagination:{el:".feedback-pagination-list",clickable:!0,bulletClass:"feedback-pagination-item",bulletActiveClass:"is-active",dynamicMainBullets:6,renderBullet:(s,o)=>`<li class="${o}"></li>`},spaceBetween:24,breakpoints:{0:{slidesPerView:1},768:{slidesPerView:2},1440:{slidesPerView:3}}})}catch(t){console.error("Failed to load feedbacks",t)}}const T=document.querySelectorAll(".feedback-btn");T.forEach(e=>{e.addEventListener("click",()=>{T.forEach(t=>t.classList.remove("is-active")),e.classList.add("is-active")})});ce();
//# sourceMappingURL=index.js.map
